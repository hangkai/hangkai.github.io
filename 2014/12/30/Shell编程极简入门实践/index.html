
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu_union_verify" content="d1952c66cf48912e21c18c7c581f382a">
  <meta name="360-site-verification" content="67fbcc5a67f4c65c057315b28fa0b2c8" />
<meta name="google-site-verification" content="2GzxQ0VtXwTSUdmGm6DzcmhTzM_I9QmzCb_pzpMzD88" />
  
    <title>Shell编程极简入门实践 | Hang&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="hang">
    
    <meta name="description" content="Shell编程极简入门实践

By StevenSLXie (Last updated: 29, Dec, 2014)

0. 写在前面

程序员多多少少都会和命令行打交道，一些常用的命令，比如cd、ls、ping等等，使用起来可能问题不大。但大多数人对Shell编程的了解程度，可能仅止于那几个最常">
    
    
    
    
    <link rel="alternate" href="atom.xml" title="Hang&#39;s blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            var _bdId ='391982416296a0d54221f59fe35250d4';
             hm.src = "//hm.baidu.com/hm.js?" + _bdId;
             var s = document.getElementsByTagName("script")[0]; 
             s.parentNode.insertBefore(hm, s);
        })();
    </script>
     
</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Hang&#39;s blog">Hang&#39;s blog</a></h1>
				<a class="blog-motto"></a>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
                                            <form class="search" action=http://search.lkh.im/cse/search target="_blank">
                                            <label>Search</label>
                                        <input name="s" type="hidden" value= 7885676667158166336 ><input type="text" name="q" size="30" placeholder="搜索"><br>
					
					</li>
				</ul>
                            </nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/12/30/Shell编程极简入门实践/" title="Shell编程极简入门实践" itemprop="url">Shell编程极简入门实践</a>
  </h1>
  <p class="article-author">By
    
      <a href="www.lkh.im" title="hang">hang</a>
    </p>
  <p class="article-time">
    <time datetime="2014-12-30T09:04:40.000Z" itemprop="datePublished">12月 30 2014</time>
    更新日期:<time datetime="2014-12-30T09:05:53.000Z" itemprop="dateModified">12月 30 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">Shell编程极简入门实践</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">By StevenSLXie (Last updated: 29, Dec, 2014)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.1.</span> <span class="toc-text">0. 写在前面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.2.</span> <span class="toc-text">1. Hello World</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.3.</span> <span class="toc-text">2. 整数和字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.4.</span> <span class="toc-text">3. 数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.</span> <span class="toc-text">4. 运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">4.1 算术运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.2.</span> <span class="toc-text">4.2 关系判断运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.3.</span> <span class="toc-text">4.3 逻辑运算符</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.6.</span> <span class="toc-text">5. if条件判断、while循环、for循环</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#!/bin/bash"><span class="toc-number"></span> <span class="toc-text">!/bin/bash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#!/bin/bash-1"><span class="toc-number"></span> <span class="toc-text">!/bin/bash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建新文件。"><span class="toc-number"></span> <span class="toc-text">创建新文件。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#往文档写入。这里使用的是echo，通过>改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？"><span class="toc-number"></span> <span class="toc-text">往文档写入。这里使用的是echo，通过>改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。"><span class="toc-number"></span> <span class="toc-text">文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#删除标点。"><span class="toc-number"></span> <span class="toc-text">删除标点。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#大写。注意tr的使用。"><span class="toc-number"></span> <span class="toc-text">大写。注意tr的使用。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#复制文件。"><span class="toc-number"></span> <span class="toc-text">复制文件。</span></a>
		</div>
		
		<h2>Shell编程极简入门实践</h2>

<h6>By StevenSLXie (Last updated: 29, Dec, 2014)</h6>

<h4>0. 写在前面</h4>

<p>程序员多多少少都会和命令行打交道，一些常用的命令，比如<code>cd</code>、<code>ls</code>、<code>ping</code>等等，使用起来可能问题不大。但大多数人对Shell编程的了解程度，可能仅止于那几个最常用的命令。当需要更复杂的命令或者需要写一个脚本来进行批处理的时候，很多人可能感到头疼。而Unix/Linux复杂多变而又不太直观的命令常常让初学者望而却步。比如像这样的语句<code>echo &quot;123 abc&quot; | sed &#39;s/[0-9][0-9]*/&amp; &amp;/&#39;</code>的语句，再比如那些以<code>-</code>开头的参数（<code>-l -n -a</code>等等），即使从网上找到了可能符合自己要求的代码，也往往因为看不懂而无法修改化为己用。</p>
<p>这个极简教程，或者说笔记，针对的是正是这部分读者。具体地说，通过学习这篇文档，你将获得以下技能：</p>
<ul><br><li>熟练掌握Unix/Linux下的最常用命令及其最常见用法；</li><br><li>能够编写脚本，对文件进行批处理，对一些网络任务进行自动化等等；</li><br><li>避免写脚本过程中的最常见错误；</li><br><li>(Hopefully)可以借此消除对命令行的恐惧；</li><br></ul>

<p>这个教程的特点是：</p>
<ul><br><li>不求全面，只求实用。只覆盖最常用的命令及其用法；</li><br><li>以大量例子为导向；</li><br><li>一边阅读一边动手写例程的话，大约只需要1.5-2.5小时的时间；</li><br></ul>

<p>这篇文档假定你是在Linux/Unix环境下，比如Ubuntu, 比如Mac OS X。同时假定你至少了解一门其它的编程语言。这个教程的代码均在Mac OS下测试过，由于各种shell的标准差别很小，（有充足的理由相信）在别的平台应该也都能顺利运行。</p>
<h4>1. Hello World</h4>

<p>首先打开你用得最顺手的文本编辑器，在第一、二行分别打入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"Hello, World!"</span></div></pre></td></tr></table></figure>

<p>保存文件，文件可保存在你喜欢的文件夹，扩展名选择<code>.sh</code>，比如这样的文件：<code>tutorial.sh</code>。</p>
<p>接着，打开命令行工具Terminal，首先将工作目录改到你保存文件的文件夹，比如如果你将<code>tutorial.sh</code>放在<code>/Users/Steven/code</code>,则在命令行里执行以下操作</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /Users/Steven/code</div></pre></td></tr></table></figure>

<p><code>cd</code>是change directory的意思，因为我们要执行<code>tutorial.sh</code>这个脚本，所以我们要先将工作目录转到这个脚本对应的文件夹下面。接着，在命令行继续输入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +<span class="keyword">x</span> tutorial.<span class="keyword">sh</span></div></pre></td></tr></table></figure>

<p><code>chmod</code>是change mode，<code>+x</code>的意思是将<code>tutorial.sh</code>变为一个可执行的文件。</p>
<p>接下来，我们就可以运行<code>tutorial.sh</code>这个脚本了。在命令行里打入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./tutorial.<span class="keyword">sh</span></div></pre></td></tr></table></figure>

<p>如无意外，你将看到命令行里返回<code>Hello, World!</code>这个字符串！请注意，文件名前面的<code>./</code>是必不可少的，它告诉系统，就在当前的目录查找一个叫tutorial.sh的文件，如果没有<code>./</code>，系统会只在系统目录里面查找（准确来说是PATH变量定义的路径）。</p>
<p>我们回头来看看<code>tutorial.sh</code>里面的程序，目前它只有两行：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"Hello, World!"</span></div></pre></td></tr></table></figure>

<p><code>#!</code>是一个标记，它告诉系统该去哪里去寻找能“解释”<code>tutorial.sh</code>的解释器。<br><code>echo</code>是回响的意思，意思是说<code>echo</code>后面的那一串东西，都会在命令行显示出来。它和其它语言的<code>print</code>是类似的。</p>
<p>就这样，我们完成了一个最简单的bash scripting的程序编写。这里面有几点需要注意：</p>
<ul><br><li>执行脚本文件前，先要cd到文件所在的目录；</li><br><li>执行脚本文件前，先要chmod +x tutorial.sh将其变为可执行程序；</li><br><li>脚本文件的第一行，记得写上#!/bin/bash。</li><br></ul>

<h4>2. 整数和字符串</h4>

<p>变量的定义很简单，按照以下格式就可以了：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">NAME</span>=<span class="string">var</span></div></pre></td></tr></table></figure>

<p>比如定义一个字符串：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NAME=<span class="string">'Steven'</span></div></pre></td></tr></table></figure>

<p>比如定义一个整型变量：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">NUM</span>=<span class="string">3</span></div></pre></td></tr></table></figure>

<p>这里有几点要注意，一是变量的名字，虽然大小写不限，但按照惯例一般采用全大写的方式。第二点特别重要，让我们做一个小实验来说明一下。打开刚才的那个<code>tutorial.sh</code>文件，将之前的内容清空，并打入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line">NAME = <span class="string">'Steven'</span></div><div class="line"><span class="built_in">echo</span> <span class="variable">$NAME</span></div></pre></td></tr></table></figure>

<p>如果你是直接复制以上的代码段，那么命令行应该会出现以下错误信息：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./tutorial.sh: <span class="built_in">line</span> <span class="number">2</span>: NAME: <span class="command"><span class="keyword">command</span> <span class="title">not</span> <span class="title">found</span></span></div></pre></td></tr></table></figure>

<p>出现这个错误，是因为：定义变量时，<code>=</code>的前面和后面，都是不能有空格的！这一点可能和其它语言不一样，但请务必注意。因为出现这类错误时，报错信息定位的栏数（line 2），是指向你引用变量的那一段代码，而不是定义变量的那一行，因此debug起来可能不是那么直观。</p>
<p>于是，我们把代码改为：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line">NAME=<span class="string">'Steven'</span></div><div class="line"><span class="built_in">echo</span> <span class="variable">$NAME</span></div></pre></td></tr></table></figure>

<p>命令行将显示<code>Steven</code>。</p>
<p>从上面的例子我们也可以看到，当你定义了一个变量，要引用它时，要在前面加上<code>$</code>。变量名两边可以加上花括号，比如这样<code>${NAME}</code>。花括号不是必须的，但最好养成加上的习惯。因为在某些情况下，不加花括号可能引发歧义<a href="https://github.com/qinjx/30min_guides/blob/master/shell.md" target="_blank" rel="external">[1]</a>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line">NAME=<span class="string">'Steven'</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"My name is <span class="variable">${NAME}</span>SLXie."</span></div></pre></td></tr></table></figure>

<p>可想而知，如果没有花括号，NAME和后面的SLXie就无法区分了。</p>
<p>对于字符串变量，既可以用单括号，比如<code>&#39;Steven&#39;</code>，也可以用双括号<code>&quot;Steven&quot;</code>，它们之间有微妙而繁杂的区别，在这里我们先记住一点，当字符串里面包含对某个变量的引用时，必须用双括号。比如上面的<code>&quot;My name is ${NAME}SLXie.&quot;</code>。请试着将它的双括号改为单括号，并观察它的输出结果。</p>
<p>单括号会将被引用字符串中的几乎所有特殊字符当作普通字符处理，比如上面的<code>$</code>，单括号时只把它当作一个普通的美元符号输出。</p>
<p>再看一个例子，试着在脚本分别输入这两行，并观察它们的输出。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"Here is <span class="variable">$50</span>."</span></div><div class="line"><span class="built_in">echo</span> <span class="string">'Here is $50.'</span></div></pre></td></tr></table></figure>

<p>在这里插播一句，看这个教程的时候，最好是看到那里，就动手写到哪里。写的时候，不要直接复制粘贴，而是试着手打代码到编辑器里面。有时候代码里有一些微小而琐碎的东西，一定要自己打一遍才能记得牢。比如，一开始可能容易将<code>#!/bin/bash</code>打成<code>#/bin/bash</code>，或者<code>#!bin/bash</code>。</p>
<p>花括号<code>{}</code>也可以用来对字符串进行某些操作。比如下面这个例子：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/bash</span></div><div class="line">USERNAME=<span class="string">'StevenSLXie'</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"My name is <span class="variable">${USERNAME}</span>. People usually call me <span class="variable">${USERNAME:0:6}</span>."</span></div></pre></td></tr></table></figure>

<p>它会输出：</p>
<p><code>My name is StevenSLXie. People usually call me Steven.</code></p>
<p>这时候，<code>${USERNAME:0:6}</code>的作用是取字符串的一部分。第一个数字0是指截取的起始部分，则第二个数字6则是指截取的长度。再比如<code>${#USERNAME}</code>则是获取字符串的长度。更多的字符串用法，我们将在后面的正则表达式哪一节看到。</p>
<p><h4>3. 数组</h4><br>数组可以这样简单粗暴地定义：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NAMES[<span class="number">0</span>]=<span class="string">'Steven'</span></div><div class="line">NAMES[<span class="number">1</span>]=<span class="string">'Peter'</span></div><div class="line">NAMES[<span class="number">2</span>]=<span class="string">'David'</span></div></pre></td></tr></table></figure>

<p>当数组体量太大时，这样定义未免麻烦，因此我们也可以用一行声明的方式来定义：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">declare</span> <span class="operator">-a</span> NAMES=(<span class="string">'Steven'</span> <span class="string">'Peter'</span> <span class="string">'David'</span>)</div></pre></td></tr></table></figure>

<p>用<code>declare -a</code>来声明，后面一次性定义所有数组元素。请注意，在这里，整个数组用小括号括起来，而每个数组元素之间，是用空格来隔开的，而不是逗号或者其它。</p>
<p>访问数组的其中一个元素，和其它语言没什么不同。在你声明好数组之后，就可以访问数组元素了：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="variable">${NAMES[0]}</span></div><div class="line"><span class="built_in">echo</span> <span class="variable">${NAMES[2]}</span></div><div class="line"><span class="built_in">echo</span> <span class="variable">${NAMES[*]}</span></div></pre></td></tr></table></figure>

<p><code>${NAMES[*]}</code>或者<code>${NAMES[@]}</code>表示访问所有元素。而<code>${#NAMES[*]}</code>则返回数组长度。请注意它和<code>${#NAMES}</code>的区别，后者是返回<code>NAMES</code>里面第一个元素的长度，相当于<code>${#NAMES[0]}</code>。</p>
<p>一个数组声明并定义后，我们仍可以二次定义它，比如下面的代码是在原来的数组基础上再添加一个人名。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">declare</span> <span class="operator">-a</span> NAMES=(<span class="string">'Steven'</span> <span class="string">'Peter'</span> <span class="string">'David'</span>)</div><div class="line"><span class="built_in">echo</span> <span class="variable">${#NAMES[*]}</span></div><div class="line">NAMES=(<span class="string">"<span class="variable">${NAMES[*]}</span>"</span> <span class="string">'Nancy'</span>)</div><div class="line"><span class="built_in">echo</span> <span class="variable">${NAMES[*]}</span></div></pre></td></tr></table></figure>

<p>命令行将返回：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">3</div><div class="line">Steven Peter David Nancy</div></pre></td></tr></table></figure>

<p><h4>4. 运算符</h4></p>
<p><h5>4.1 算术运算符</h5><br>Shell编程里的算术运算符和大多数编程语言很类似，主要是这些<code>+ - * / %</code>等。如果你试着在命令行里执行运算的话，比如输入以下算式：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2 + 2</div></pre></td></tr></table></figure>

<p>会得到：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"><span class="symbol">bash:</span> <span class="number">2</span><span class="symbol">:</span> command <span class="keyword">not</span> found</span></div></pre></td></tr></table></figure>

<p>这条错误信息。这是因为命令行的逻辑是它会把一行命令的第一个词当作是命令，在系统中寻找与之匹配的执行语句，因为在这里它会认为2是一个命令，而显然它不可能找到这个命令。要想执行运算，我们在命令行里打入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">expr</span> <span class="number">2</span> + <span class="number">2</span></div></pre></td></tr></table></figure>

<p>输出结果是<code>4</code>。<code>expr</code>是一个常用命令，evaluate an expression的意思。注意，这里数字和运算符之间，必须有一个空格。不然的话，如果你输入，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">expr</span> <span class="number">2</span>+<span class="number">2</span></div></pre></td></tr></table></figure>

<p>则会输出</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2+2</div></pre></td></tr></table></figure>

<p>这种情况下，<code>expr</code>会把后面的<code>2+2</code>当成一个字符串，而evaluate一个字符串的结果，自然就是它本身了。算术运算当然也可以用变量，比如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">VAR</span>=<span class="number">5</span></div><div class="line">expr <span class="number">2</span> + ${<span class="keyword">VAR</span>}</div></pre></td></tr></table></figure>

<p>其它的算术运算符大体类似，但有一个要特别注意，如果你进行乘法运算，比如:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">expr</span> <span class="number">2</span> * <span class="number">15</span></div></pre></td></tr></table></figure>

<p>会输出：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">expr</span>: <span class="string">syntax error</span></div></pre></td></tr></table></figure>

<p>这是因为<code>*</code>是一个特殊的字符（后面还会介绍到），而当要表达其原来的意思是，我们需要在它前面加上下划线<code>\</code>。就像这样：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">expr</span> <span class="number">2</span> \* <span class="number">15</span></div></pre></td></tr></table></figure>

<p><h5>4.2 关系判断运算符</h5><br>Shell提供了丰富的关系判断运算符，先来看一个例子，在<code>tutorial.sh</code>加入以下代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">A=<span class="number">10</span></div><div class="line">B=<span class="number">15</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="variable">$A</span> <span class="operator">-eq</span> <span class="variable">$B</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'True'</span></div><div class="line"><span class="keyword">else</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'False'</span></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>

<p>这是一个<code>if</code>条件判别语句(后面再细讲)。<code>-eq</code>判断运算符左右两边是否相等，如果是，则返回<code>True</code>，不然就返回<code>False</code>。关系判断运算符的基本格式是<code>[ VAR1 OPERATOR VAR2 ]</code>，用一个中括号括起来，这里有一点细节要注意，中括号和变量之间，需要有空格隔开。所以像<code>[$A -eq $B]</code>是会报错的。（不如自己写段代码试一试？）</p>
<p>完整的关系判断运算符文档可以看这里：<a href="" http:="" www.tutorialspoint.com="" unix="" unix-basic-operators.htm="">Unix Basic Operator</a></p>
<p><h5>4.3 逻辑运算符</h5><br>与主流编程语言用<code>&amp;&amp; and || or</code>来做逻辑判断稍有不同，Shell编程里，与逻辑和或逻辑分别是用<code>-o</code>和<code>-a</code>来表示的。看看下面这个例子：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">A=<span class="number">10</span></div><div class="line">B=<span class="number">15</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="variable">$A</span> <span class="operator">-lt</span> <span class="number">8</span> <span class="operator">-a</span> <span class="variable">$B</span> <span class="operator">-gt</span> <span class="number">8</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'True'</span></div><div class="line"><span class="keyword">else</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'False'</span></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>

<p>这是判断变量A是否小于8且变量B是否大于B。</p>
<p>完整的关系判断运算符文档可以看这里：<a href="" http:="" www.tutorialspoint.com="" unix="" unix-basic-operators.htm="">Unix Basic Operator</a></p>
<p><h4>5. if条件判断、while循环、for循环</h4><br><code>if | while | for</code>语句和其它主流语言很相似，因此用起来应该不是大问题。值得注意的可能是以下几个小点：</p>
<ul><br><li>if语句的格式是if…then…elif…fi。注意，这里用fi来标记一个条件判断的结束。嗯，感觉是一种很调皮的设定。</li><br><li>所有的while和for语句，其执行的语句都始于do，终于done。</li><br><li>for的格式是for VAR in ARRAY，是Python的样式，和经典的C for循环可能稍有不同。</li><br></ul>

<p>下面我们用一个例子来感受一下这三种语句。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">'Shall we begin the demo?(y/n)'</span></div><div class="line"><span class="built_in">read</span> ANS</div><div class="line"></div><div class="line">A=<span class="number">0</span></div><div class="line"><span class="keyword">declare</span> <span class="operator">-a</span> B=(<span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="variable">$ANS</span> = <span class="string">'y'</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'Output the results of the while loop'</span></div><div class="line">    <span class="keyword">while</span> [ <span class="variable">$A</span> <span class="operator">-lt</span> <span class="number">10</span> ]</div><div class="line">    <span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="variable">$A</span></div><div class="line">        A=`expr <span class="variable">$A</span> + <span class="number">1</span>`</div><div class="line">        B=(<span class="variable">${B[*]}</span> <span class="variable">$A</span>)</div><div class="line">    <span class="keyword">done</span></div><div class="line"><span class="keyword">else</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'Not ready for the demo yet.'</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="string">'Output the results of the for loop.'</span></div><div class="line"><span class="keyword">for</span> I <span class="keyword">in</span> <span class="variable">${B[*]}</span></div><div class="line">    <span class="keyword">do</span></div><div class="line">        <span class="built_in">echo</span> <span class="variable">$I</span></div><div class="line">    <span class="keyword">done</span></div></pre></td></tr></table></figure>

<p>第二行的<code>read</code>在这个文档是第一次出现，它的功能是从Terminal里读取一行，并将这一行内容赋给<code>read</code>后面的那个变量。在这个例子里，我们询问用户是否要开始<code>demo</code>，当得到肯定回答后，用户的回答（假定是<code>y</code>），将被赋给<code>ANS</code>这个变量。</p>
<p>接着，我们用一个<code>if</code>判断语句，如果用户回答是<code>y</code>，则执行<code>while</code>循环。<code>while</code>循环的内容比较简单，在每一次循环里，先打印出<code>A</code>的值，接着将<code>A</code>的值加一，然后将每一个得到的新的<code>A</code>放进数组<code>B</code>里面。当<code>A</code>大于等于10的时候，退出循环。</p>
<p>最后是一个<code>for</code>循环，<code>for</code>的功能是将数组<code>B</code>里面的元素依次打印出来。</p>
<p>这里要补充一点，在对<code>A</code>加一的时候，我们使用的是</p>
<figure class="highlight A=`expr"><figcaption><span>$A + 1` ```，如果你试图使用类似`A=$A + 1`这样的赋值，将会报错。这是因为如前所述，每一个算术运算，都需要用`expr`来算出它的结果。那`expr`两边的``` ` ` ```又是怎么回事呢？这里的``` ` ` ```其实是命令输出的引用，我们知道```expr $A + 1```本身是一个命令语句，而当我们要引用这个语句的执行结果的时候，就要加上``` ` ` ```了。举一个比较容易理解的例子吧：如果你在命令行输入`date`，就会输出系统的当前时间，这时候`date`是一个命令，但如果你要将`date`这个命令的执行结果赋给一个变量`D`，就要```D=`date` ```。同样的，如果我们要将`5 + 25`的结果赋给一个变量`SUM`，则需要```SUM=`expr 5 + 25` ```。</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>

<p> <code> </code> </p>
<figure class="highlight 在键盘上的位置是在`Tab`上面，`1`的左边。"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">还有一点要注意，当我们对一个已经定义过的变量进行重新赋值的时候，是不需要加<span class="escape">`$</span><span class="escape">`的</span>，上面的例子</div></pre></td></tr></table></figure>

<p>A=<code>expr $A + 1</code> </p>
<figure class="highlight 和```B=(${B[*]}"><figcaption><span>$A)```里，等式左边的变量都不需要加`$`。</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">h4</span>&gt;</span>6. 函数<span class="tag">&lt;/<span class="title">h4</span>&gt;</span></div><div class="line">Shell脚本里当然可以定义函数。比如这样的：</div></pre></td></tr></table></figure>

<p>hello(){<br>    echo “Hello World!”<br>}</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">函数可以直接调用，比如下面这个脚本：</div></pre></td></tr></table></figure>

<h1 id="!/bin/bash">!/bin/bash</h1>
<p>hello(){<br>    echo “Hello World!”<br>}</p>
<p>hello</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">注意，但函数没有参数时，调用只需要写上函数名，而不是<span class="escape">`h</span>ello()<span class="escape">`之</span>类的。</div><div class="line"></div><div class="line">Shell函数的特殊之处，在于它参数传递的形式，具体地说，参数并不是像别的语言一样，写在括号里面，而是类似下面这个例子：</div></pre></td></tr></table></figure>

<p>intro(){<br>    echo “There are $1 people here. They are $2, $3.”<br>}</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Shell用<span class="escape">`$</span><span class="number">1</span><span class="escape">` </span><span class="escape">`$</span><span class="number">2</span><span class="escape">`这</span>样的特殊记号来标记函数参数。而<span class="escape">`$</span><span class="number">0</span><span class="escape">`则</span>是函数名，<span class="escape">`$</span>n<span class="escape">`表</span>示第<span class="escape">`n</span><span class="escape">`个</span>参数。调用上面的<span class="escape">`i</span>ntro<span class="escape">`函</span>数，则是这个样子：</div></pre></td></tr></table></figure>

<p>intro 2 ‘Steven’ ‘David’</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">命令行的输出则是：</div></pre></td></tr></table></figure>

<p>There are 2 people here. They are Steven, David.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">参数不是写在括号里，而是在函数名之后依次排列，并以空格隔开。</div><div class="line"></div><div class="line">函数也可以有返回值，比如：</div></pre></td></tr></table></figure>

<p>hello(){<br>    A=<code>expr 5 \* 10</code><br>    return $A<br>}</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">返回变量<span class="escape">`A</span><span class="escape">`的</span>值。请注意，这里获取返回值的方式和其它语言可能不太一样。并不是<span class="escape">`A</span>=hello<span class="escape">`，</span>而是：</div></pre></td></tr></table></figure>

<p>hello<br>RET=$?</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="escape">`$</span>?<span class="escape">`是</span>一个特殊字符，它保留上一个命令的执行结果。因此，当我们要获取<span class="escape">`h</span>ello<span class="escape">`函</span>数的返回值时，就在调用该函数后，紧接着将<span class="escape">`$</span>?<span class="escape">`赋</span>给存储返回值的变量<span class="escape">`r</span>et<span class="escape">`。</span>在这里，这两句命令是必须紧挨着的，如果中间还有其它语句，则<span class="escape">`$</span>?<span class="escape">`会</span>返回最近一次的命令执行结果，而不一定是<span class="escape">`h</span>ello<span class="escape">`的</span>返回值。</div><div class="line"></div><div class="line"></div><div class="line">&lt;h4&gt;<span class="number">7</span>. sed和正则表达式&lt;/h4&gt;</div><div class="line">正则表达式是一种特殊的字符串，用来描述一串具有某种共同特征的字符串。在进行批处理的时候，正则表达式有着异常强大的应用。</div><div class="line"></div><div class="line">sed则是一个流编辑器(stream editor)，它读入一个输出，并通过加工处理，输出经处理后的 文件/字符串 输出。下面我们通过一系列例子，来掌握sed的基本应用。</div><div class="line"></div><div class="line">首先我们要来新建一些txt文件供sed处理。在命令行输入：</div></pre></td></tr></table></figure>

<p>mkdir files<br>cd files<br>touch test-1.txt<br>touch test-2.txt<br>touch test-3.txt<br>cd ../</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">第一行<span class="escape">`m</span>kdir<span class="escape">`是</span>在当前目录下新建一个叫<span class="escape">`f</span>iles<span class="escape">`的</span>文件夹。然后我们<span class="escape">`c</span>d<span class="escape">`到</span>新的文件夹里，在里面用<span class="escape">`t</span>ouch<span class="escape">`新</span>建三个<span class="escape">`t</span>xt<span class="escape">`文</span>档。接着，通过<span class="escape">`c</span>d ../<span class="escape">`回</span>到上级目录，也就是我们的<span class="escape">`t</span>utorial.sh<span class="escape">`所</span>在的目录里。</div><div class="line"></div><div class="line">然后，分别打开那三个<span class="escape">`t</span>xt<span class="escape">`文</span>件，将以下几行字符串拷贝到文件里。</div></pre></td></tr></table></figure>

<p>This is a file with several lines<br>some of which are blank lines<br>for example, the line that follows is blank</p>
<p>But this line has several characters.</p>
<p>And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">接着，打开我们的<span class="escape">`t</span>utorial.sh<span class="escape">`，</span>将之前内容清空，只留下第一行的<span class="escape">`#</span>!/usr/bash<span class="escape">`。</span>在里面输入：</div></pre></td></tr></table></figure>

<p>cd files<br>FILE=test-1.txt</p>
<p>sed -i.tmp “/^$/d” $FILE</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">保存后运行<span class="escape">`.</span>/tutorial.sh<span class="escape">`。</span>然后打开<span class="escape">`t</span>est-<span class="number">1</span>.txt<span class="escape">`，</span>如无意外的话，你会看到文档变成这个样子：</div></pre></td></tr></table></figure>

<p>This is a file with several lines<br>some of which are blank lines<br>for example, the line that follows is blank<br>But this line has several characters.<br>And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">所有的空行被删除了。我们来看看<span class="escape">`s</span>ed -i.tmp <span class="string">"/^$/d"</span> $FILE<span class="escape">`这</span>句命令。其中<span class="escape">`"</span>/^$/d<span class="string">"<span class="escape">`描</span>述了sed作用于什么模式(pattern)，以及操作(action)，它的基本结构是这样的"</span>/pattern/action<span class="string">"。其中<span class="escape">`p</span>attern<span class="escape">`里</span>面是一个正则表达式，表面了我们要寻找什么样的字符串(pattern match)，找到之后，则是对这个字符串进行操作(action)。在我们这个例子里，我们的正则表达式是<span class="escape">`"</span>^$"</span><span class="escape">`，</span>其中<span class="escape">`^</span><span class="escape">`是</span>标记一个字符串的开始，而<span class="escape">`$</span><span class="escape">`是</span>标记一个字符串的结束。在这里，开始和结束连在一起，表示我们要寻找的是一个空字符串，而对它的操作是<span class="escape">`d</span><span class="escape">`，</span><span class="escape">`d</span>elete<span class="escape">`的</span>意思。整个句子合起来就是，<span class="escape">`s</span>ed<span class="escape">`会</span>打开<span class="escape">`t</span>est-<span class="number">1</span>.txt<span class="escape">`，</span>逐行扫描，找到空行，删除掉空行。</div><div class="line"></div><div class="line">而<span class="escape">`s</span>ed<span class="escape">`前</span>面的 <span class="escape">`-</span>i<span class="escape">`则</span>是<span class="escape">`i</span>n place<span class="escape">`的</span>意思，就是说我们这个操作是直接对目标文件下手的。这样的修改通常是比较危险的（万一改错了呢），所以一个安全的办法是在<span class="escape">`-</span>i<span class="escape">`后</span>面加上<span class="escape">`-</span>i.tmp<span class="escape">`，</span>意思是每次改动，我们都会保留一个后缀为<span class="escape">`.</span>tmp<span class="escape">`的</span>备份文件。于是你打开文件夹的话，会看到多出了一个<span class="escape">`t</span>est-<span class="number">1</span>.txt.tmp<span class="escape">`。</span>如果你确认你的改动没有问题之后，就可以把这个备份文件删掉了。备份文件的扩展名可以随意，因为当你需要它的时候总是需要把它改回<span class="escape">`t</span>xt<span class="escape">`的</span>。但最好扩展名不要和文件夹的已有文件重复。</div><div class="line"></div><div class="line">接着你可以试试将上面的<span class="escape">`s</span>ed<span class="escape">`语</span>句改为：</div></pre></td></tr></table></figure>

<p>sed -e “/^$/d” test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这时你会发现改动后的结果，在命令行显示出来了，而原文件并不会改动。</div><div class="line"></div><div class="line">再来看下面的语句：</div></pre></td></tr></table></figure>

<p>sed -e “1,3d” test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这个语句的意思，就是删除<span class="escape">`t</span>est-<span class="number">2</span>.txt<span class="escape">`中</span>的第一到第三行。观察输出可以看到，前三行被删除了。类似地，<span class="escape">`s</span>ed -e <span class="string">"2,4!d"</span> test-<span class="number">2</span>.txt<span class="escape">`则</span>是指，除了<span class="number">2</span>-<span class="number">4</span>行，其他都删掉。<span class="escape">`s</span>ed -e <span class="string">"d"</span> test-<span class="number">2</span>.txt<span class="escape">` </span>则是删除文档里面的全部内容。请注意，为了避免频繁改动文档，以上几个命令都是用的<span class="escape">`-</span>e<span class="escape">`，</span>改动是体现在命令行的输出的。如果要直接对文档进行改动，请用<span class="escape">`-</span>i.tmp<span class="escape">`，</span>或者分开写为<span class="escape">`-</span>i '.tmp'<span class="escape">`。</span>在Mac OS X的Bash Shell里面，似乎提供一个备份文件的扩展名是必须的，而在Linux平台则似乎是可选的。</div><div class="line"></div><div class="line">更为常见的<span class="escape">`s</span>ed<span class="escape">`的</span>应用，是用它来进行替换。看看下面的例子：</div></pre></td></tr></table></figure>

<p>sed -e ‘s/But/but/‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">命令行的输出：</div></pre></td></tr></table></figure>

<p>This is file with several lines<br>some of which are blank lines<br>for example, the line that follows is blank</p>
<p>but this line has several characters.</p>
<p>And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">可以观察到，首字母大写的<span class="escape">`B</span>ut<span class="escape">`被</span>替换成<span class="escape">`b</span>ut<span class="escape">`。</span>替换的基本格式是<span class="escape">`'</span>s/<span class="literal">a</span>/b/'<span class="escape">`，</span><span class="escape">`a</span><span class="escape">`和</span><span class="escape">`b</span><span class="escape">`分</span>别代表替换前和替换后。我们再来多看几个例子，首先将<span class="escape">`t</span>est-<span class="number">2</span>.txt<span class="escape">`文</span>档的内容改为：</div></pre></td></tr></table></figure>

<p>1.This is file with several lines<br>2.some of which are blank lines<br> for example, the line that follows is blank</p>
<p>7.But this line has several characters.</p>
<p> And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">第三行和最后一行前面有一个空格。接着我们在<span class="escape">`t</span>utorial.sh<span class="escape">`里</span>面加入以下命令：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/^[ 1-3]//‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">你会看到以下输出：</div></pre></td></tr></table></figure>

<p>.This is file with several lines<br>.some of which are blank lines<br>for example, the line that follows is blank</p>
<p>7.But this line has several characters.</p>
<p>And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">在这个例子里，正则表达式<span class="escape">`^</span>[ <span class="number">1</span>-<span class="number">3</span>]<span class="escape">`的</span><span class="escape">`^</span><span class="escape">`表</span>示字符串的开始，而中括号表示匹配任意一个在中括号里面的字符。我们的中括号里面有空格以及数字<span class="number">1</span>-<span class="number">3</span>，而之后<span class="escape">`*</span><span class="escape">`表</span>示零到任意多个任意字符。于是，<span class="escape">`s</span>ed<span class="escape">`根</span>据正则表达式的要求去逐行扫描，找出“以空格或者数字<span class="number">1</span>-<span class="number">3</span>开头的行”。</div><div class="line"></div><div class="line">找到之后干什么呢？这就要看第二个<span class="escape">`/</span><span class="escape">`后</span>面的内容了，而我们发现第二个<span class="escape">`/</span><span class="escape">`和</span>第三个<span class="escape">`/</span><span class="escape">`之</span>间并没有内容。这是说，找到了符合要求的这个字符串，就将其替换为空字符。于是你可以看到以上的输出了。第一行第二行的数字被移除，第三行和最后一行的空格被移除，而第五行的数字<span class="number">7</span>则不受影响。</div><div class="line"></div><div class="line">保留新的<span class="escape">`t</span>est-<span class="number">2</span>.txt<span class="escape">`，</span>我们继续执行以下命令：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/[!.]$/;/‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这个命令则是找出以<span class="escape">`!</span><span class="escape">` </span><span class="escape">`.</span><span class="escape">`结</span>尾的行，并一律改为以分号结尾。</div><div class="line"></div><div class="line">我们继续在原有的文档操作，输入以下命令：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/^[. 1-9]*//;s/[;.!]$/ ENDING/‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这是两个替换命令一起来。首先，我们找出以<span class="escape">`.</span><span class="escape">` </span>或者数字<span class="number">1</span>-<span class="number">9</span>,或者空格开头的行，然后将其删掉。请注意，这里有一个<span class="escape">`*</span><span class="escape">`，</span>它代表了任意多个（包括<span class="number">0</span>）前一个字符的重复。比如如果一个行是以三个空格开头的，则加上<span class="escape">`*</span><span class="escape">`可</span>以加之一并铲除，如果不加的话就只会匹配并删除第一个空格。两个合并命令之间以空格隔开。第二个命令是找出以分号句号或者感叹号结尾的行，代之以<span class="escape">` </span>ENDING<span class="escape">`。</span></div><div class="line"></div><div class="line">输出结果应该是：</div></pre></td></tr></table></figure>

<p>This is file with several lines<br>some of which are blank lines<br>for example, the line that follows is blank</p>
<p>But this line has several characters ENDING</p>
<p>And this marks the end of the file ENDING</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">回头看这个命令，<span class="smartquote">`sed -i '</span>.tmp' <span class="emphasis">'s/^[. 1-9]*//;s/[;.!]$/ ENDING/'</span> test-2.txt`。两个小时之前，如果你看到这么复杂的命令行的时候，很有可能因为看起来过于复杂而崩溃掉吧。但现在，你也能读、写这样复杂的命令了。恭喜！</div><div class="line"></div><div class="line">让我们继续来看看<span class="code">`sed`</span>的一些其它应用。</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/^some.*//‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">删除以<span class="escape">`s</span>ome<span class="escape">`开</span>头的行。其中<span class="escape">`.</span><span class="escape">`可</span>以指代任意字符。</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/….$//‘ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">删除每行末尾的四个字符。</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘s/But/but/g’ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这个看起来有点熟悉对不对？如果你比较之前的语句，会发现多了一个<span class="escape">`g</span><span class="escape">`。</span>在这里，如果不加<span class="escape">`g</span><span class="escape">`则</span>只会替换每行的第一个<span class="escape">`B</span>ut<span class="escape">`，</span>而加<span class="escape">`g</span><span class="escape">`则</span>会替换所有的<span class="escape">`B</span>ut<span class="escape">`。</span>如果你只是要替换某一个位置的<span class="escape">`B</span>ut<span class="escape">`，</span>比如第三个，则可以<span class="escape">`s</span>ed -i '.tmp' 's/But/but/<span class="number">3</span>' test-<span class="number">2</span>.txt<span class="escape">`。</span></div><div class="line"></div><div class="line">除了删除和替换，<span class="escape">`s</span>ed<span class="escape">`还</span>支持插入(insert/append)新的字符串。</div><div class="line"></div><div class="line">比如下面的例子：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘3 a\<br>just some random text’ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">它的功能是往<span class="escape">`t</span>est-<span class="number">2</span>.txt<span class="escape">`的</span>第三行后面添加<span class="escape">`j</span>ust some random text<span class="escape">`这</span>一新行。注意<span class="escape">`a</span>\<span class="escape">`之</span>后要另起一行，这里<span class="escape">`a</span><span class="escape">`是</span><span class="escape">`a</span>ppend<span class="escape">`的</span>意思。如果<span class="escape">`a</span>\<span class="escape">`改</span>为<span class="escape">`i</span>\<span class="escape">`，</span>则是在前面加新行。<span class="escape">`i</span><span class="escape">`是</span><span class="escape">`i</span>nsert<span class="escape">`的</span>意思。</div><div class="line"></div><div class="line">另外一个例子：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘$ a\<br>just some random text’ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">在文件末尾处加上新行。</div><div class="line"></div><div class="line">当然我们也可以用正则表达式要判别，比如：</div></pre></td></tr></table></figure>

<p>sed -i ‘.tmp’ ‘/text/ i\<br>INSERT THIS BEFORE EVERY LINE CONTAINING TEXT’ test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">在每一行包含<span class="string">`text`</span>的行前面加入<span class="string">`INSERT THIS BEFORE EVERY LINE CONTAINING TEXT`</span>。</div><div class="line"></div><div class="line">更多的<span class="string">`sed`</span>用法，可以参考：http:<span class="regexp">//www</span>.grymoire.com/Unix/Sed.html<span class="comment">#uh-1 。</span></div><div class="line"></div><div class="line">&lt;h4&gt;<span class="number">9</span>. <span class="keyword">grep</span>&lt;<span class="regexp">/h4&gt;</span></div><div class="line">grep相当于Unix/Linux命令行的Google，可以快速地找出包含某个字符串的文件。让我们先将当前目录移到<span class="string">`files`</span>子文件夹，并显示该目录下的所有文件名。</div></pre></td></tr></table></figure>

<p>cd files<br>ls</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">如果你按照这个教程一路走下来，现在这个文件夹里面应该有<span class="smartquote">`test-1.txt test-2.txt test-3.txt`几个文件，以及可能的备份文件。如果不是也不要紧。接下来我们执行一个grep，来找出`test-1.txt`里面包含`'</span>file'`的那些行。</div></pre></td></tr></table></figure>

<p>grep “file” test-1.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">正常的话会输出：</div></pre></td></tr></table></figure>

<p>This is file with several lines<br>And this marks the end of the file.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这两行包含着<span class="escape">`f</span>ile<span class="escape">`。</span></div><div class="line"></div><div class="line"><span class="escape">`g</span>rep<span class="escape">`可</span>以同时搜索多个文件，比如这样：</div></pre></td></tr></table></figure>

<p>grep “file” test-1.txt test-2.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">输出则是：</div></pre></td></tr></table></figure>

<p>test-1.txt:This is file with several lines<br>test-1.txt:And this marks the end of the file.<br>test-2.txt:This is file with several li<br>test-2.txt:And this marks the end of the file END</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">格式是<span class="code">`文件名:字符串`</span>。当然，罗列所有的文件名，有时候很不方便。这时候可以用上模糊搜索。比如这样：</div></pre></td></tr></table></figure>

<p>grep “file” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">有时候你只想知道哪些文件包含了某个字符串，而对那一行的具体内容是什么并不重要，那么可以这样：</div></pre></td></tr></table></figure>

<p>grep -l “file” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">系统会打印出包含<span class="escape">`f</span>ile<span class="escape">`的</span>文件名。有的时候你想多知道一点：不想打印出整行字符串，但想知道每个文件有几行包含<span class="escape">`f</span>ile<span class="escape">`，</span>那么可以：</div></pre></td></tr></table></figure>

<p>grep -c “file” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">而有时候你想知道的非常多，不仅是文件名，出现了几行，而且具体的行数也要知道，那么可以：</div></pre></td></tr></table></figure>

<p>grep -n “file” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">有的时候你想知道输出相反的结果：那些不包含<span class="escape">`f</span>ile<span class="escape">`的</span>行，那么可以：</div></pre></td></tr></table></figure>

<p>grep -vn “file” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="escape">`g</span>rep<span class="escape">`当</span>然也支持正则表达式。要知道，<span class="escape">`g</span>rep<span class="escape">`的</span>全称就是<span class="escape">`g</span>lobal regular expression print<span class="escape">`。</span>所以“你问我支持不支持，他的名字叫全局正则表达式打印器，怎么能不支持？”（请忽略一个蛤丝的老梗~）。</div><div class="line"></div><div class="line">我们来看几个例子：</div></pre></td></tr></table></figure>

<p>grep “END$” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">输出结尾为<span class="escape">`E</span>ND<span class="escape">`的</span>那些行。</div></pre></td></tr></table></figure>

<p>grep “file|But” test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">输出含有<span class="escape">`f</span>ile<span class="escape">`或</span>者<span class="escape">`B</span>ut<span class="escape">`的</span>行。注意<span class="escape">`|</span><span class="escape">`前</span>面需要用<span class="escape">`\</span><span class="escape">`。</span></div><div class="line"></div><div class="line">如果我们要搜索包含<span class="escape">`c</span>haracters.<span class="escape">`的</span>行，正确的命令是这样的：</div></pre></td></tr></table></figure>

<p>grep ‘characters.‘ test-*.txt</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">同时试一试<span class="smartquote">`grep '</span>characters.' test-<span class="strong">*.txt`，看看结果有什么不同。</span></div><div class="line"></div><div class="line"></div><div class="line">&lt;h4&gt;10. 写一个脚本吧&lt;/h4&gt;</div><div class="line"></div><div class="line">前面九节基本上覆盖了Shell编程最基本的内容，这一节我们来动手写一个脚本，一方面是把我们之前学到的东西复习一下，串联起来。另一方面，是将之前没有覆盖到的几个常用命令介绍一下。</div><div class="line"></div><div class="line">我们的任务是在当前目录下，新建一个脚本<span class="code">`final-script.sh`</span>。然后在脚本里新建一个文件夹<span class="code">`final`</span>，在新文件夹里批量新建十个<span class="code">`.txt`</span>文件，命名规则为<span class="code">`final-test-n.txt`</span>。每个文件的文档内容<span class="code">`"This is a test file...!!"`</span>。</div><div class="line"></div><div class="line">接着，将十个文件的文件名从<span class="code">`final-test-n.txt`</span>改为<span class="code">`Final-test-n.txt`</span>。</div><div class="line"></div><div class="line">然后，删除文件内容里面的标点符号。</div><div class="line"></div><div class="line">接着，将文件内容全部变成大写。</div><div class="line"></div><div class="line">将改动后的文件，拷贝一份到任意一个新的文件夹。</div><div class="line"></div><div class="line">请注意，这当中会出现一些我们没学到的知识，如果你发现现有的知识不足以解决问题的话，请Google之。</div><div class="line"></div><div class="line">下面是我写的脚本，为了便于理解，我将各个命令都分开写了。</div></pre></td></tr></table></figure>

<h1 id="!/bin/bash-1">!/bin/bash</h1>
<p>mkdir final<br>cd final</p>
<p>declare -a NAME<br>NAME=(1 2 3 4 5 6 7 8 9 10)</p>
<h1 id="创建新文件。">创建新文件。</h1>
<p>for I in ${NAME[*]}<br>    do<br>        touch final-test-${I}.txt<br>    done</p>
<h1 id="往文档写入。这里使用的是echo，通过&gt;改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？">往文档写入。这里使用的是echo，通过<code>&gt;</code>改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？</h1>
<p>for F in final-test-*.txt<br>    do<br>        echo ‘This is a test file…!!’ &gt; $F<br>    done</p>
<h1 id="文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。">文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。</h1>
<p>for F in final-test-*.txt<br>    do<br>        NEW=$(echo “$F” | sed -e ‘s/^./F/‘)<br>        mv “$F” “$NEW”<br>    done</p>
<h1 id="删除标点。">删除标点。</h1>
<p>for F in *.txt<br>    do<br>        sed -i.tmp ‘s/…!!$//‘ $F<br>    done</p>
<h1 id="大写。注意tr的使用。">大写。注意tr的使用。</h1>
<p>for F in *.txt<br>    do<br>        tr ‘[:lower:]’ ‘[:upper:]’ &lt; $F &gt; FILE2<br>        mv FILE2 $F<br>    done</p>
<p>cd ../<br>mkdir repo</p>
<p>cd final</p>
<h1 id="复制文件。">复制文件。</h1>
<p>for F in *.txt<br>    do<br>        cp $F ../repo/$F<br>    done<br>```</p>
<p>原文链接(<a href="https://github.com/StevenSLXie/Shell-Programming-Tutorial/edit/master/%E6%95%99%E7%A8%8B.md" target="_blank" rel="external">https://github.com/StevenSLXie/Shell-Programming-Tutorial/edit/master/%E6%95%99%E7%A8%8B.md</a>);</p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/shell/">shell</a><a href="/tags/linux/">linux</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/linux/">linux</a>
</div>



<div class="article-share" id="share">

  <div data-url="www.lkh.im/2014/12/30/Shell编程极简入门实践/" data-title="Shell编程极简入门实践 | Hang&#39;s blog" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2014/12/29/使用Lock同步代码块/"  title="使用Lock同步代码块">
 <strong>NEXT:</strong><br/> 
 <span>使用Lock同步代码块
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">Shell编程极简入门实践</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">By StevenSLXie (Last updated: 29, Dec, 2014)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.1.</span> <span class="toc-text">0. 写在前面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.2.</span> <span class="toc-text">1. Hello World</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.3.</span> <span class="toc-text">2. 整数和字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.4.</span> <span class="toc-text">3. 数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.</span> <span class="toc-text">4. 运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">4.1 算术运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.2.</span> <span class="toc-text">4.2 关系判断运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.5.3.</span> <span class="toc-text">4.3 逻辑运算符</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined"><span class="toc-number">1.0.6.</span> <span class="toc-text">5. if条件判断、while循环、for循环</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#!/bin/bash"><span class="toc-number"></span> <span class="toc-text">!/bin/bash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#!/bin/bash-1"><span class="toc-number"></span> <span class="toc-text">!/bin/bash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建新文件。"><span class="toc-number"></span> <span class="toc-text">创建新文件。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#往文档写入。这里使用的是echo，通过>改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？"><span class="toc-number"></span> <span class="toc-text">往文档写入。这里使用的是echo，通过>改变其默认输出。不妨思考一下如果用sed来实现会有什么问题？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。"><span class="toc-number"></span> <span class="toc-text">文件名首字母大写。注意echo和sed的连用，以及我们引用命令的一种新方法$(command)。还有mv这个新命令。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#删除标点。"><span class="toc-number"></span> <span class="toc-text">删除标点。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#大写。注意tr的使用。"><span class="toc-number"></span> <span class="toc-text">大写。注意tr的使用。</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#复制文件。"><span class="toc-number"></span> <span class="toc-text">复制文件。</span></a>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-logo"></div>		
	
	<div class="social-list" class="clearfix">
		
		<a href="http://weibo.com/u/1934773961" target="_blank" title="weibo"></a>
		
		
		
		
		
	</div>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/java/" title="java">java<sup>1</sup></a></li>
		
			<li><a href="/categories/linux/" title="linux">linux<sup>2</sup></a></li>
		
			<li><a href="/categories/多线程/" title="多线程">多线程<sup>1</sup></a></li>
		
			<li><a href="/categories/缓存/" title="缓存">缓存<sup>2</sup></a></li>
		
			<li><a href="/categories/运维/" title="运维">运维<sup>3</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/cache/" title="cache">cache<sup>2</sup></a></li>
		
			<li><a href="/tags/centos/" title="centos">centos<sup>3</sup></a></li>
		
			<li><a href="/tags/java/" title="java">java<sup>1</sup></a></li>
		
			<li><a href="/tags/jdbcTemplate/" title="jdbcTemplate">jdbcTemplate<sup>1</sup></a></li>
		
			<li><a href="/tags/linux/" title="linux">linux<sup>4</sup></a></li>
		
			<li><a href="/tags/lock/" title="lock">lock<sup>1</sup></a></li>
		
			<li><a href="/tags/lvs/" title="lvs">lvs<sup>1</sup></a></li>
		
			<li><a href="/tags/redis/" title="redis">redis<sup>2</sup></a></li>
		
			<li><a href="/tags/shell/" title="shell">shell<sup>1</sup></a></li>
		
			<li><a href="/tags/ubuntu/" title="ubuntu">ubuntu<sup>1</sup></a></li>
		
			<li><a href="/tags/vi/" title="vi">vi<sup>1</sup></a></li>
		
			<li><a href="/tags/多线程/" title="多线程">多线程<sup>1</sup></a></li>
		
			<li><a href="/tags/缓存/" title="缓存">缓存<sup>1</sup></a></li>
		
			<li><a href="/tags/虚拟机/" title="虚拟机">虚拟机<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="linkslist">
    <p class="asidetitle">友情链接</p>
    <ul>
        <li>
            <a title="lixumin" target="_blank" href="http://www.lixumin.com">夜半微凉</a>
        </li>
        <li>
            <a title="土鳖" target="_blank" href="http://www.only29.im">土鳖</a>
        </li>
    </ul>

</div>


  <div class="rsspart">
	<a href="atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/cache/" style="font-size: 13.33px;">cache</a><a href="/tags/centos/" style="font-size: 16.67px;">centos</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/jdbcTemplate/" style="font-size: 10.00px;">jdbcTemplate</a><a href="/tags/linux/" style="font-size: 20.00px;">linux</a><a href="/tags/lock/" style="font-size: 10.00px;">lock</a><a href="/tags/lvs/" style="font-size: 10.00px;">lvs</a><a href="/tags/redis/" style="font-size: 13.33px;">redis</a><a href="/tags/shell/" style="font-size: 10.00px;">shell</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/vi/" style="font-size: 10.00px;">vi</a><a href="/tags/多线程/" style="font-size: 10.00px;">多线程</a><a href="/tags/缓存/" style="font-size: 10.00px;">缓存</a><a href="/tags/虚拟机/" style="font-size: 10.00px;">虚拟机</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
    
            <p class="copyright"> © 2014 
		
		<a href="www.lkh.im" target="_blank" title="hang">hang</a>
		
            && Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> && Theme by <a href="http://gengbiao.me" target="_blank" title="coney">coney</a>
            </div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"lkh"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





<script>
    
        var _bdImg = '8';
    
    window._bd_share_config={
        "common":{
            "bdSnsKey":{

            },
            "bdText":"",
            "bdMini":"2",
            "bdMiniList":[
                "qzone",
                "tsina",
                "weixin",
                "renren",
                "tqq",
                "tieba",
                "douban",
                "sqq",
                "diandian",
                "huaban",
                "youdao",
                "mail",
                "ty",
                "fbook",
                "twi",
                "linkedin",
                "copy",
                "print"
            ],
            "bdPic":"",
            "bdStyle":"0",
            "bdSize":"16"
        },
        "slide":{
            "type":"slide",
            "bdImg":_bdImg,
            "bdPos":"right",
            "bdTop":"350"
        },
        "image":{
            "viewList":[
                "weixin",
                "qzone",
                "tsina",
                "renren",
                "douban",
                "tqq"
            ],
            "viewText":"分享：",
            "viewSize":"16"
        },
        "selectShare":{
            "bdContainerClass":null,
            "bdSelectMiniList":[
                "weixin",
                "qzone",
                "tsina",
                "renren",
                "douban",
                "tqq"
            ]
        }
    };
    with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>




<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'null', 'null');  
ga('send', 'pageview');
</script>


  </body>
</html>

